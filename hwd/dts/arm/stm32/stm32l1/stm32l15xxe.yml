cpu:
  information:
    model: {%block cpu_model %} 'stm32l15xxe' {% endblock %}

    series: 'stm32l1'
    family: 'stm32'
    vendor: 'st'

  peripherals:
    usart:
      - id: 'usart1'
        type: 'uart'
        device: 'USART1'
        bus: 'APB2'
        rcc: 'RCC_APB2ENR_USART1EN'
        irqn: 'USART1_IRQn'
        isr: 'isr_usart1'
        tx_dma: 'dma1'
        tx_dma_stream: 4
        tx_dma_channel: 2
        rx_dma: 'dma1'
        rx_dma_stream: 5
        rx_dma_channel: 2

      - id: 'usart2'
        type: 'uart'
        device: 'USART2'
        bus: 'APB1'
        rcc: 'RCC_APB1ENR_USART2EN'
        irqn: 'USART2_IRQn'
        isr: 'isr_usart2'
        tx_dma: 'dma1'
        tx_dma_stream: 7
        tx_dma_channel: 2
        rx_dma: 'dma1'
        rx_dma_stream: 6
        rx_dma_channel: 2


      - id: 'usart3'
        type: 'uart'
        device: 'USART3'
        bus: 'APB1'
        rcc: 'RCC_APB1ENR_USART3EN'
        irqn: 'USART3_IRQn'
        isr: 'isr_usart3'
        tx_dma: 'dma1'
        tx_dma_stream: 2
        tx_dma_channel: 2
        rx_dma: 'dma1'
        rx_dma_stream: 3
        rx_dma_channel: 2

    dma:
      - id: 'dma1'
        type: 'dma'
        device: 'DMA1'

      - id: 'dma2'
        type: 'dma'
        device: 'DMA2'

    spi:
      - id: 'spi1'
        type: 'spi'
        device: 'SPI1'
        bus: 'APB2'
        rcc: 'RCC_APB2ENR_SPI1EN'
        tx_dma: 'dma1'
        tx_dma_stream: 3
        tx_dma_channel: 1
        rx_dma: 'dma1'
        rx_dma_stream: 2
        rx_dma_channel: 1

      - id: 'spi2'
        type: 'spi'
        device: 'SPI2'
        bus: 'APB1'
        rcc: 'RCC_APB1ENR_SPI2EN'
        tx_dma: 'dma1'
        tx_dma_stream: 5
        tx_dma_channel: 1
        rx_dma: 'dma1'
        rx_dma_stream: 4
        rx_dma_channel: 1

    i2c:
      - id: 'i2c1'
        type: 'i2c'
        device: 'I2C1'
        bus: 'APB1'
        rcc: 'RCC_APB1ENR_I2C1EN'
        clk: 'CLOCK_APB1'
        irqn: 'I2C1_EV_IRQn'
        isr: 'isr_i2c1_ev'
        tx_dma: 'dma1'
        tx_dma_stream: 6
        tx_dma_channel: 3
        rx_dma: 'dma1'
        rx_dma_stream: 7
        rx_dma_channel: 3

      - id: 'i2c2'
        type: 'i2c'
        device: 'I2C2'
        bus: 'APB1'
        rcc: 'RCC_APB1ENR_I2C2EN'
        clk: 'CLOCK_APB1'
        irqn: 'I2C2_EV_IRQn'
        isr: 'isr_i2c2_ev'
        tx_dma: 'dma1'
        tx_dma_stream: 4
        tx_dma_channel: 3
        rx_dma: 'dma1'
        rx_dma_stream: 5
        rx_dma_channel: 3

    pinmuxes:
      usart_pinmux:
        - periph: 'usart2'
          tx: 'PA2'
          rx: 'PA3'
          tx_af: 'GPIO_AF7'
          rx_af: 'GPIO_AF7'

        - periph: 'usart1'
          tx: 'PA9'
          rx: 'PA10'
          tx_af: 'GPIO_AF7'
          rx_af: 'GPIO_AF7'

        - periph: 'usart1'
          tx: 'PB6'
          rx: 'PB7'
          tx_af: 'GPIO_AF7'
          rx_af: 'GPIO_AF7'

        - periph: 'usart3'
          tx: 'PB10'
          rx: 'PB11'
          tx_af: 'GPIO_AF7'
          rx_af: 'GPIO_AF7'

        - periph: 'usart3'
          tx: 'PC10'
          rx: 'PC11'
          tx_af: 'GPIO_AF7'
          rx_af: 'GPIO_AF7'

        - periph: 'usart2'
          tx: 'PD5'
          rx: 'PD6'
          tx_af: 'GPIO_AF7'
          rx_af: 'GPIO_AF7'

        - periph: 'usart3'
          tx: 'PD8'
          rx: 'PD9'
          tx_af: 'GPIO_AF7'
          rx_af: 'GPIO_AF7'
        
      spi_pinmux:
        - periph: 'spi1'
          mosi: 'PA7'
          miso: 'PA6'
          af: 'GPIO_AF5'

        - periph: 'spi1'
          mosi: 'PA12'
          miso: 'PA11'
          af: 'GPIO_AF5'

        - periph: 'spi1'
          mosi: 'PB5'
          miso: 'PB4'
          af: 'GPIO_AF5'

        - periph: 'spi1'
          mosi: 'PE15'
          miso: 'PE14'
          af: 'GPIO_AF5'

        - periph: 'spi2'
          mosi: 'PB15'
          miso: 'PB14'
          af: 'GPIO_AF5'

        - periph: 'spi2'
          mosi: 'PD3'
          miso: 'PD4'
          af: 'GPIO_AF5'

      i2c_pinmux:
        - periph: 'i2c1'
          scl: 'PB6'
          sda: 'PB7'
          scl_af: 'GPIO_AF4'
          sda_af: 'GPIO_AF4'

        - periph: 'i2c1'
          scl: 'PB8'
          sda: 'PB9'
          scl_af: 'GPIO_AF4'
          sda_af: 'GPIO_AF4'

        - periph: 'i2c2'
          scl: 'PB10'
          sda: 'PB11'
          scl_af: 'GPIO_AF4'
          sda_af: 'GPIO_AF4'

  pins:
    {% for port in ['A', 'B', 'C', 'D', 'E'] %}
    {% for num in range(16) %}
      - port: '{{ port }}'
        num: {{ num }}
    {% endfor %}
    {% endfor %}
      - port: 'H'
        num: 0
      - port: 'H'
        num: 1
      - port: 'H'
        num: 2

